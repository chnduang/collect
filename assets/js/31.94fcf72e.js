(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{323:function(n,s,t){"use strict";t.r(s);var a=t(4),e=Object(a.a)({},(function(){var n=this,s=n._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[n._v("最近在使用 MongoDB，在创建用户时遇到了 Error: couldn"),s("span",{pre:!0,attrs:{class:"token string"}},[n._v("'t add user: No role named userAdminAnyDatabase@xttblog : 异常问题。今天把这个问题的解决办法分享给大家！\n\n整个错误异常信息如下：\n\nError: couldn'")]),n._v("t "),s("span",{pre:!0,attrs:{class:"token function"}},[n._v("add")]),n._v(" user: No role named userAdminAnyDatabase@xttblog "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[n._v(":")]),n._v("\n_getErrorWithCode@src/mongo/shell/utils.js:25:13\nDB.prototype.createUser@src/mongo/shell/db.js:1290:15\n@"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("shell"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v(":1:1\n\n大概的意思是说，我的 xttblog 这个库没有 userAdminAnyDatabase 这个角色。\n\n后来我查找了官方的资料，发现 userAdminAnyDatabase 这个角色只能使用于 admin 这个库。\n\n也就是说对于 admin 库，你可以正确的执行下面的语句。\n\nuse admin\ndb.createUser"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n        user: "),s("span",{pre:!0,attrs:{class:"token string"}},[n._v('"xttblog"')]),n._v(",\n        pwd: "),s("span",{pre:!0,attrs:{class:"token string"}},[n._v('"test"')]),n._v(",\n        roles: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v(" role: "),s("span",{pre:!0,attrs:{class:"token string"}},[n._v('"userAdminAnyDatabase"')]),n._v(", db: "),s("span",{pre:!0,attrs:{class:"token string"}},[n._v('"admin"')]),n._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),n._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v("\n\n对于非 admin 库，不能拥有 clusterAdmin、readAnyDatabase、readWriteAnyDatabase、userAdminAnyDatabase、dbAdminAnyDatabase 这些角色。\n\nuse xttblog\ndb.createUser"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v("\n        user: "),s("span",{pre:!0,attrs:{class:"token string"}},[n._v('"xttblog"')]),n._v(",\n        pwd: "),s("span",{pre:!0,attrs:{class:"token string"}},[n._v('"test"')]),n._v(",\n        roles: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("[")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("{")]),n._v(" role: "),s("span",{pre:!0,attrs:{class:"token string"}},[n._v('"dbAdmin"')]),n._v(", db: "),s("span",{pre:!0,attrs:{class:"token string"}},[n._v('"xttblog"')]),n._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("]")]),n._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("}")]),n._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v("\n\n上面的语句可以正确的执行。\n\nMongoDB 目前内置了 "),s("span",{pre:!0,attrs:{class:"token number"}},[n._v("7")]),n._v(" 个角色。\n\n数据库用户角色：read、readWrite"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(";")]),n._v("\n数据库管理角色：dbAdmin、dbOwner、userAdmin；\n集群管理角色：clusterAdmin、clusterManager、clusterMonitor、hostManager；\n备份恢复角色：backup、restore；\n所有数据库角色：readAnyDatabase、readWriteAnyDatabase、userAdminAnyDatabase、dbAdminAnyDatabase\n超级用户角色：root；这里还有几个角色间接或直接提供了系统超级用户的访问（dbOwner 、userAdmin、userAdminAnyDatabase）\n内部角色：__system\n这些角色对应的作用如下：\n\nRead：允许用户读取指定数据库\nreadWrite：允许用户读写指定数据库\ndbAdmin：允许用户在指定数据库中执行管理函数，如索引创建、删除，查看统计或访问system.profile\nuserAdmin：允许用户向system.users集合写入，可以找指定数据库里创建、删除和管理用户\nclusterAdmin：只在admin数据库中可用，赋予用户所有分片和复制集相关函数的管理权限。\nreadAnyDatabase：只在admin数据库中可用，赋予用户所有数据库的读权限\nreadWriteAnyDatabase：只在admin数据库中可用，赋予用户所有数据库的读写权限\nuserAdminAnyDatabase：只在admin数据库中可用，赋予用户所有数据库的userAdmin权限\ndbAdminAnyDatabase：只在admin数据库中可用，赋予用户所有数据库的dbAdmin权限。\nroot：只在admin数据库中可用。超级账号，超级权限\n")])])]),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[n._v("mongodb://username:password@my-server/myBase?authSource"),s("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v("admin\n\nauthSource用来表明验证身份的来源数据库\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);